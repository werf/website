Дизайн `readinessProbe` (дословно: «проверка на готовность [к обслуживанию запросов]»), пожалуй, оказался не очень удачным. Она сочетает в себе две функции: проверять, что приложение в контейнере стало доступным при запуске контейнера, и проверять, что приложение остаётся доступным уже после его запуска. На практике первое нужно практически всегда, а второе примерно настолько же часто, насколько оказывается нужной `livenessProbe`. Проблемы с плохими `readinessProbe` примерно те же самые, что и с плохими `livenessProbe`, и в худшем случае также могут приводить к длительной недоступности приложения.

{% include 300_deployment_practices/010_life_cycle/partials/010_main_recomendation.liquid %}

Когда `readinessProbe` перестаёт отрабатывать, то на Pod перестаёт приходить трафик. В большинстве случаев такое поведение мало помогает, т. к. трафик обычно балансируется между Pod'ами более-менее равномерно. Таким образом, чаще всего `readinessProbe` либо работает везде, либо не работает сразу на большом количестве Pod'ов. Есть ситуации, когда подобное поведение `readinessProbe` может понадобиться, но в нашей практике это скорее исключение.

Тем не менее, у `readinessProbe` есть другая очень важная функция: определить, когда только что запущенное в контейнере приложение стало способно принимать трафик, чтобы не пускать трафик в ещё не доступное приложение. Эта же функция `readinessProbe`, напротив, нужна нам почти всегда.

Получается странная ситуация, что одна функция `readinessProbe` обычно очень нужна, а другая очень не нужна. Эта проблема была решена введением `startupProbe`, которая [появилась в Kubernetes 1.16](https://habr.com/ru/company/flant/blog/467477/) и перешла в Beta в 1.18. Таким образом, **рекомендуем для проверки готовности приложения при его запуске в Kubernetes < 1.18 использовать `readinessProbe`, а в Kubernetes >= 1.18 — использовать `startupProbe`**. `readinessProbe` всё ещё можно использовать в Kubernetes >= 1.18, если у вас есть необходимость останавливать трафик на отдельные Pod'ы уже после старта приложения.
